# Data Model: Embedding Pipeline for Docusaurus URLs

## Entities

### 1. Document Chunk
- **Description**: Represents a segment of content extracted from a URL
- **Fields**:
  - `id` (str): Unique identifier for the chunk (UUID or URL-based)
  - `content` (str): The cleaned text content (500-1000 token segment)
  - `source_url` (str): Original URL from which the content was extracted
  - `chunk_index` (int): Position of the chunk within the source document
  - `created_at` (datetime): Timestamp of when the chunk was created
  - `metadata` (dict): Additional metadata like title, headings in the chunk
- **Relationships**: Belongs to a source URL

### 2. Embedding Vector
- **Description**: Numerical representation of text content generated by the Cohere model
- **Fields**:
  - `chunk_id` (str): Reference to the Document Chunk
  - `vector` (list[float]): The embedding vector from Cohere model
  - `model` (str): Name of the model used (e.g., "multilingual-v3")
  - `created_at` (datetime): Timestamp of when the embedding was generated
- **Relationships**: Belongs to a Document Chunk

### 3. URL Processing Record
- **Description**: Record of processing status for each URL
- **Fields**:
  - `url` (str): The URL being processed
  - `status` (str): Processing status (e.g., "pending", "processing", "completed", "failed")
  - `processed_at` (datetime): Timestamp when processing was completed
  - `error_message` (str): Error message if processing failed
  - `chunk_count` (int): Number of chunks created from the URL
- **Relationships**: Contains many Document Chunks

## Validation Rules

### Document Chunk
- Content length must be sufficient to represent meaningful information
- Source URL must be a valid URL
- Chunk index must be non-negative

### Embedding Vector
- Vector must match the expected dimensionality of the Cohere model
- Must reference a valid Document Chunk ID

### URL Processing Record
- Status must be one of the defined values
- Error message only if status is "failed"

## State Transitions

### URL Processing Record
- `pending` → `processing`: When processing begins
- `processing` → `completed`: When all chunks are successfully embedded and stored
- `processing` → `failed`: When processing fails due to error
- `failed` → `pending`: When retrying after failure